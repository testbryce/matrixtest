name: workflow

on:
  push:
    branches: [main]

env:
  SOLUTION_DIR: ./src/console

jobs:
  build-and-test:
    uses: ./.github/workflows/build.yaml
    with:
      publish-artifact: true
  
  deploy-npe:
    needs: build-and-test
    
    uses: ./.github/workflows/run.yaml
    secrets: inherit
    with:
      environment: npe
      
  deploy-prd:
    needs: deploy-npe

    uses : ./.github/workflows/run.yaml
    secrets: inherit
    with:
      environment: prd
